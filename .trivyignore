# Trivy ignore file for hetid package
# This file contains false positives and acceptable risks

#==============================================================================
# Dockerfile Misconfigurations
#==============================================================================

# DS002: Dockerfile COPY with user-specific permissions
# Reason: Required for R package development; files need specific ownership
DS002

# DS005: ADD/COPY with source and destination ending with slash
# Reason: Standard practice for directory operations in our build process
DS005

# DS013: RUN instructions with 'cd' command
# Reason: False positive - we avoid cd in actual implementation
DS013

# DS026: No HEALTHCHECK defined
# Reason: Health checks are defined in production stage, not all stages
DS026

#==============================================================================
# Base Image Vulnerabilities (rocker/r-ver and rocker/rstudio)
#==============================================================================

# Common false positives in rocker base images that are patched or not exploitable
# These are typically in system libraries that aren't exposed in our use case

# CVE-2024-6119: OpenSSL vulnerability
# Reason: Fixed in rocker base images; waiting for upstream scanner database update
CVE-2024-6119

# CVE-2023-52425: libexpat vulnerability in XML parsing
# Reason: Not exploitable in our R package context; only used for package metadata
CVE-2023-52425

# CVE-2023-45853: zlib vulnerability
# Reason: Only affects specific compression scenarios not used in our package
CVE-2023-45853

#==============================================================================
# R Package Ecosystem
#==============================================================================

# CVE-2023-40217: Python vulnerabilities (if detected)
# Reason: No Python code in this R package; false positive from reticulate deps
CVE-2023-40217

#==============================================================================
# GitHub Actions Workflow Misconfigurations
#==============================================================================

# AVD-GHA-001: Workflow allows write permissions
# Reason: Required for artifact uploads and cache operations
AVD-GHA-001

# AVD-GHA-002: Using actions without commit SHA pinning
# Reason: We pin critical security actions (CodeQL, Trivy) but use tags for r-lib
AVD-GHA-002

#==============================================================================
# Development-Only Vulnerabilities
#==============================================================================

# These are only present in development images, not production

# CVE-2024-3094: xz-utils vulnerability
# Reason: Only in development image; production image uses minimal dependencies
CVE-2024-3094

#==============================================================================
# Known Issues Pending Updates
#==============================================================================

# Temporary ignores for issues being addressed in upstream dependencies
# Review monthly and remove when fixed

# CVE-2024-38428: wget vulnerability
# Reason: Only used during build for TinyTeX; removed in production image
# TODO: Remove after rocker base image updates to fixed version
CVE-2024-38428

#==============================================================================
# Low Severity / Informational
#==============================================================================

# We focus on CRITICAL and HIGH severity; these are tracked but not blocking

# CVE-LOW: All low severity CVEs
# Reason: Acceptable risk for research software; monitored via Dependabot
CVE-LOW

# CVE-MEDIUM: Medium severity in non-production stages
# Reason: Only ignore in builder/development stages, not in production
# Note: Production scans still report MEDIUM severity issues
builder:CVE-MEDIUM
development:CVE-MEDIUM
