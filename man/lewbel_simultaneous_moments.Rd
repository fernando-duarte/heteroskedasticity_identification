% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lewbel-gmm.R
\name{lewbel_simultaneous_moments}
\alias{lewbel_simultaneous_moments}
\title{Define GMM Moment Conditions for Lewbel Simultaneous System}
\usage{
lewbel_simultaneous_moments(
  theta,
  data,
  y1_var,
  y2_var,
  x_vars,
  z_vars,
  add_intercept,
  z_sq
)
}
\arguments{
\item{theta}{Numeric vector. Parameters: c(beta1, gamma1, beta2, gamma2).}

\item{data}{Data frame containing all required variables. Must include the
dependent variables and any exogenous regressors specified in the model.}

\item{y1_var}{Character. Name of the first dependent variable (default: "Y1").}

\item{y2_var}{Character. Name of the second dependent variable/endogenous regressor (default: "Y2").}

\item{x_vars}{Character vector. Names of exogenous variables (default: "Xk").}

\item{z_vars}{Character vector. Names of heteroskedasticity drivers (default: NULL, uses centered X).}

\item{add_intercept}{Logical. Whether to add an intercept to the exogenous variables (default: TRUE).}

\item{z_sq}{Logical. Whether to include squared terms in the Z matrix for simultaneous equations.}
}
\value{
Matrix of moment conditions (n x q).
}
\description{
Creates the moment function for GMM estimation of a simultaneous equations
system using Lewbel's heteroskedasticity-based identification.
}
\details{
For the simultaneous system:
\deqn{Y_1 = X'\beta_1 + \gamma_1 Y_2 + \epsilon_1}
\deqn{Y_2 = X'\beta_2 + \gamma_2 Y_1 + \epsilon_2}

where \eqn{\epsilon_1} and \eqn{\epsilon_2} are the structural errors.
Note: Requires \eqn{\gamma_1 \gamma_2 \neq 1} for identification.

The moment conditions are the same as the triangular system.
}
\references{
Lewbel, A. (2012). Using heteroscedasticity to identify and estimate
mismeasured and endogenous regressor models. Journal of Business & Economic
Statistics, 30(1), 67-80. \doi{10.1080/07350015.2012.643126}
}
\seealso{
\code{\link{lewbel_gmm}} for the main GMM estimation function.
\code{\link{lewbel_triangular_moments}} for triangular system moments.
}
