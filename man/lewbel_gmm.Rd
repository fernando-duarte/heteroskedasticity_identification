% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lewbel-gmm.R
\name{lewbel_gmm}
\alias{lewbel_gmm}
\title{Estimate Lewbel Model using GMM}
\usage{
lewbel_gmm(
  data,
  system = c("triangular", "simultaneous"),
  y1_var = "Y1",
  y2_var = "Y2",
  x_vars = "Xk",
  z_vars = NULL,
  gmm_type = c("twoStep", "iterative", "cue"),
  initial_values = NULL,
  vcov = c("HAC", "iid", "cluster"),
  cluster_var = NULL,
  ...
)
}
\arguments{
\item{data}{Data frame containing all variables.}

\item{system}{Character. Type of system: "triangular" or "simultaneous" (default: "triangular").}

\item{y1_var}{Character. Name of the first dependent variable (default: "Y1").}

\item{y2_var}{Character. Name of the second dependent variable/endogenous regressor (default: "Y2").}

\item{x_vars}{Character vector. Names of exogenous variables (default: "Xk").}

\item{z_vars}{Character vector. Names of heteroskedasticity drivers (default: NULL).}

\item{gmm_type}{Character. GMM type: "twoStep", "iterative", or "cue" (default: "twoStep").}

\item{initial_values}{Numeric vector. Initial parameter values (default: NULL, uses OLS).}

\item{vcov}{Character. Type of variance-covariance matrix: "HAC", "iid", or "cluster" (default: "HAC").}

\item{cluster_var}{Character. Variable name for clustering if vcov = "cluster" (default: NULL).}

\item{...}{Additional arguments passed to gmm().}
}
\value{
An object of class "gmm" containing estimation results.
}
\description{
Main function to estimate Lewbel's heteroskedasticity-based identification
model using Generalized Method of Moments (GMM).
}
\details{
This function implements Lewbel's (2012) heteroskedasticity-based identification
using the GMM framework. The method exploits heteroskedasticity in the error
terms to generate valid instruments for endogenous regressors.
}
\examples{
\dontrun{
# Generate example data
set.seed(123)
n <- 1000
params <- list(
  beta1_0 = 0.5, beta1_1 = 1.5, gamma1 = -0.8,
  beta2_0 = 1.0, beta2_1 = -1.0,
  alpha1 = -0.5, alpha2 = 1.0, delta_het = 1.2
)
data <- generate_lewbel_data(n, params)

# Estimate triangular system
gmm_tri <- lewbel_gmm(data, system = "triangular")
summary(gmm_tri)

# Estimate simultaneous system
gmm_sim <- lewbel_gmm(data, system = "simultaneous")
summary(gmm_sim)

# Compare with 2SLS
tsls_result <- run_single_lewbel_simulation(1, c(params, sample_size = n))
cat("2SLS estimate:", tsls_result$tsls_gamma1, "\n")
cat("GMM estimate:", coef(gmm_tri)["gamma1"], "\n")
}

}
\seealso{
\code{\link{lewbel_triangular_moments}}, \code{\link{lewbel_simultaneous_moments}} for moment condition functions.
\code{\link{rigobon_gmm}} for regime-based heteroskedasticity identification.
\code{\link{prono_gmm}} for GARCH-based heteroskedasticity identification.
\code{\link{compare_gmm_2sls}} for comparing GMM with 2SLS estimates.
\code{\link{run_single_lewbel_simulation}} for 2SLS implementation.
}
