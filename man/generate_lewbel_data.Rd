% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data-generation.R
\name{generate_lewbel_data}
\alias{generate_lewbel_data}
\title{Generate Data for Lewbel (2012) Triangular Model}
\usage{
generate_lewbel_data(n_obs, params)
}
\arguments{
\item{n_obs}{Integer. Sample size.}

\item{params}{List. Parameters for the data generating process containing:
\itemize{
\item beta1_0, beta1_1: Parameters for first equation
\item beta2_0, beta2_1: Parameters for second equation
\item gamma1: Endogenous parameter (key parameter of interest)
\item alpha1, alpha2: Factor loadings for common factor U
\item delta_het: Heteroscedasticity strength parameter
}}
}
\value{
A data.frame with columns Y1, Y2, Xk, Z, epsilon1, epsilon2.
}
\description{
Creates a dataset based on the triangular model with single-factor error
structure that satisfies Lewbel's identifying assumptions. The data
generating process uses
a common factor structure for the errors to ensure the covariance restriction
Cov(Z, \eqn{\epsilon_1 \epsilon_2}) = 0 is satisfied.
}
\details{
The triangular model is:
\deqn{Y_1 = \beta_{1,0} + \beta_{1,1}X + \gamma_1 Y_2 + \epsilon_1}
\deqn{Y_2 = \beta_{2,0} + \beta_{2,1}X + \epsilon_2}

The error structure follows a single-factor model:
\deqn{\epsilon_1 = \alpha_1 U + V_1}
\deqn{\epsilon_2 = \alpha_2 U + V_2}

where U, V_1 are independent standard normal, and V_2 ~ N(0, exp(\eqn{\delta}
Z))
with Z = X^2 - E\link{X^2} being the heteroscedasticity driver.
}
\examples{
\dontrun{
params <- list(
  beta1_0 = 0.5, beta1_1 = 1.5, gamma1 = -0.8,
  beta2_0 = 1.0, beta2_1 = -1.0,
  alpha1 = -0.5, alpha2 = 1.0, delta_het = 1.2
)
data <- generate_lewbel_data(1000, params)
head(data)
}

}
