% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data-generation.R
\name{generate_lewbel_data}
\alias{generate_lewbel_data}
\title{Generate Data for Lewbel (2012) Triangular Model}
\usage{
generate_lewbel_data(n, params)
}
\arguments{
\item{n}{Integer. Sample size.}

\item{params}{List. Parameters for the data generating process containing:
\itemize{
\item beta1_0, beta1_1: Parameters for first equation
\item beta2_0, beta2_1: Parameters for second equation
\item gamma1: Endogenous parameter (key parameter of interest)
\item alpha1, alpha2: Factor loadings for common factor U
\item delta_het: Heteroscedasticity strength parameter
}}
}
\value{
A data.frame with columns Y1, Y2, Xk, Z, epsilon1, epsilon2.
}
\description{
Creates a dataset based on the triangular model with single-factor error structure
that satisfies Lewbel's identifying assumptions. The data generating process uses
a common factor structure for the errors to ensure the covariance restriction
Cov(Z, ε₁ε₂) = 0 is satisfied.
}
\details{
The triangular model is:
3duSP55piJeg1sam\deqn{Y₂ = β₂₀ + β₂₁X + ε₂}

The error structure follows a single-factor model:
3duSP55piJeg1samHrE9Ep5Zl63X\deqn{ε₂ = α₂U + V₂}

where U, V₁ are independent standard normal, and V₂ ~ N(0, exp(δZ))
with Z = X² - E\link{X²} being the heteroscedasticity driver.
}
\examples{
\dontrun{
params <- list(
  beta1_0 = 0.5, beta1_1 = 1.5, gamma1 = -0.8,
  beta2_0 = 1.0, beta2_1 = -1.0,
  alpha1 = -0.5, alpha2 = 1.0, delta_het = 1.2
)
data <- generate_lewbel_data(1000, params)
head(data)
}

}
