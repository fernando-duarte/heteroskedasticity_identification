%% LyX 2.4.3 created this file.  For more info, see https://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{geometry}
\geometry{verbose}

\makeatletter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{enumitem}% For custom list labels


% ---------- shortcuts ----------
\newcommand{\E}{\mathbb{E}}
\newcommand{\cov}{\operatorname{Cov}}
\newcommand{\corr}{\operatorname{Corr}}
\newcommand{\var}{\operatorname{Var}}
\newcommand{\plim}{\operatorname*{plim}}
\newcommand{\argmin}{\operatorname*{arg\,min}}

% ---------- theorem environments ----------
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}\newtheorem{remark}{Remark}

% ---------- transpose symbol ----------
\newcommand{\T}{^{\intercal}}

\makeatother

\begin{document}
\title{Heteroscedasticity-Based Identification}
\author{}
\maketitle

\section{Preliminaries and Notation}

This document summarizes the heteroscedasticity-based identification
strategy for models with endogenous regressors, as developed by Lewbel
(2012), Rigobon (2003) and Prono (2XXX), and proposes an application
to a time-series context. The method provides a way to construct valid
instruments from the model's data when traditional external instruments
are unavailable and heteroskedasticity is present.

Throughout, $Z \coloneqq g(X)$ denotes a transformation of the exogenous variables,
constructed to be mean-zero.\footnote{Thus, we write $Z$ to mean the centered variable $Z-\E[Z]$ for population
moments and the sample-demeaned version, $Z_{i}-\bar{Z}$, in calculations
when using empirical data in a finite sample.} All instruments are therefore understood to be mean-zero.

\section{Structural Forms and Reduced-Form Residuals}

Let $(Y_{1},Y_{2})$ be an endogenous vector, $X$ a vector of exogenous
variables (including a constant), and $Z \coloneqq g(X)$ as above. The models
we consider are:

\begin{align*}
\textbf{Triangular:}\quad & Y_{1}=X\T\beta_{1}+\gamma_{1}Y_{2}+\varepsilon_{1}, & \quad Y_{2}=X\T\beta_{2}+\varepsilon_{2},\\[3pt]
\textbf{Simultaneous:}\quad & Y_{1}=X\T\beta_{1}+\gamma_{1}Y_{2}+\varepsilon_{1}, & \quad Y_{2}=X\T\beta_{2}+\gamma_{2}Y_{1}+\varepsilon_{2}.
\end{align*}

Projecting each $Y_{j}$ on $X$ yields \emph{reduced-form residuals}
$W_{j}\coloneqq Y_{j}-X\T(\E[XX\T])^{-1}\E[XY_{j}]$. A short calculation
gives
\[
W_{1}=\frac{\varepsilon_{1}+\gamma_{1}\varepsilon_{2}}{1-\gamma_{1}\gamma_{2}},\qquad W_{2}=\frac{\varepsilon_{2}+\gamma_{2}\varepsilon_{1}}{1-\gamma_{1}\gamma_{2}},
\]
with the triangular case obtained by setting~$\gamma_{2}=0$.

\begin{remark} The algebra follows directly from solving the two-equation
system for the reduced form and collecting the error terms. \end{remark}

\section{Core Assumptions for Point Identification}

The method relies on the following key assumptions:

\begin{enumerate}[label=(A\arabic*)]
\item \textbf{Strict exogeneity.} $\E[\varepsilon_{j}\mid X]=0$ for $j=1,2$.
\emph{Time-series note:} in Section~\ref{sec:timeseries} we weaken
this to a martingale-difference assumption and add HAC inference.
\item \textbf{Covariance restriction.} $\cov(Z,\varepsilon_{1}\varepsilon_{2})=0$.
This holds automatically if the errors have a common factor structure
$\varepsilon_{j} \coloneqq a_{j}u+\eta_{j}$ where the common factor $u$ is
uncorrelated with and mean independent of $Z$.
\item \textbf{Instrument relevance via heteroscedasticity.}
\begin{itemize}
\itemsep2pt
\item \emph{Triangular:} $\cov(Z,\varepsilon_{2}^{2})\neq0$.
\item \emph{Simultaneous:} the $r\times2$ matrix $\Phi_{W} \coloneqq [\,\cov(Z,W_{1}^{2})\;\;\cov(Z,W_{2}^{2})\,]$
has rank~2.
\end{itemize}
\item \textbf{Normalization (simultaneous case).} The parameter space for
$(\gamma_{1},\gamma_{2})$ precludes the observationally equivalent
pair $(1/\gamma_{2},1/\gamma_{1})$ unless $\gamma_{1}\gamma_{2}=1$.
\end{enumerate}

\section{Triangular System: Closed-Form Identification and 2SLS}

\subsection{Closed-form}

\begin{equation}
\gamma_{1}=\frac{\cov(Z,W_{1}W_{2})}{\cov(Z,W_{2}^{2})}.\label{eq:gamma1_id}
\end{equation}

\begin{remark}[Why \eqref{eq:gamma1_id} identifies $\gamma_{1}$]
Under~(A2) the numerator simplifies to $\cov(Z,\varepsilon_{1}\varepsilon_{2})+\gamma_{1}\cov(Z,\varepsilon_{2}^{2})=\gamma_{1}\cov(Z,\varepsilon_{2}^{2})$.
Because the denominator is non-zero by (A3), $\gamma_{1}$ is point
identified. \end{remark}

\subsection{Feasible two-step 2SLS}
\begin{enumerate}
\itemsep2pt
\item \textbf{Generate residuals.} Regress $Y_{2}$ on $X$ via OLS and
store the residuals $\hat{\varepsilon}_{2} \coloneqq Y_{2}-X\T\hat{\beta}_{2}^{\text{OLS}}$.
\item \textbf{Construct the heteroscedasticity-based instrument.} The generated
instrument is $IV \coloneqq (Z-\bar{Z})\hat{\varepsilon}_{2}$.
\item \textbf{First stage.} Regress the endogenous variable $Y_{2}$ on
the exogenous variables and the generated instrument, $[X,IV]$, to
obtain fitted values $\hat{Y}_{2}$.
\item \textbf{Second stage.} Regress $Y_{1}$ on $[X,\hat{Y}_{2}]$ to estimate
$(\beta_{1},\gamma_{1})$.
\end{enumerate}

\paragraph{Practical guidance.}

Weak-instrument concerns apply because the instrument is generated.
Report the first-stage F-statistic on $IV$ and, where necessary,
use weak-IV-robust inference. Standard errors should account for the
first-stage estimation step, typically via GMM or bootstrap.

\section{GMM Moment Conditions}

The identification strategy can be expressed more generally using
GMM. The core idea is to form moment conditions that are zero at the
true parameter values $\theta$.

\subsection{Triangular system}

The parameter vector is $\theta \coloneqq (\beta_{1}\T,\gamma_{1},\beta_{2}\T)\T$.
The moment vector is formed by multiplying instruments by the model's
structural errors, which are defined as $\varepsilon_{1}(\theta) \coloneqq Y_{1}-X\T\beta_{1}-Y_{2}\gamma_{1}$
and $\varepsilon_{2}(\theta) \coloneqq Y_{2}-X\T\beta_{2}$.
\begin{equation}
Q_{\text{TRI}}(\theta) \coloneqq \begin{pmatrix}X\cdot\varepsilon_{1}(\theta)\\[3pt]
X\cdot\varepsilon_{2}(\theta)\\[3pt]
Z\cdot\varepsilon_{1}(\theta)\cdot\varepsilon_{2}(\theta)
\end{pmatrix}.\label{eq:moment_tri}
\end{equation}
The instruments are constructed directly from the exogenous data:
\begin{itemize}
\itemsep0pt
\item For the two mean equations, the instruments are the exogenous variables
$X$.
\item For the covariance restriction, the instrument is the heteroscedasticity
driver $Z$.
\end{itemize}
Since the errors are functions of data and parameters, the entire
moment vector is observable for any candidate $\theta$.

\subsection{Simultaneous system}

The parameter vector is $\theta \coloneqq (\beta_{1}\T,\gamma_{1},\beta_{2}\T,\gamma_{2})\T$.
The structural errors are now $\varepsilon_{1}(\theta) \coloneqq Y_{1}-X\T\beta_{1}-Y_{2}\gamma_{1}$
and $\varepsilon_{2}(\theta) \coloneqq Y_{2}-X\T\beta_{2}-Y_{1}\gamma_{2}$.
\begin{equation}
Q_{\text{SIM}}(\theta) \coloneqq \begin{pmatrix}X\cdot\varepsilon_{1}(\theta)\\[3pt]
X\cdot\varepsilon_{2}(\theta)\\[3pt]
Z\cdot\varepsilon_{1}(\theta)\cdot\varepsilon_{2}(\theta)
\end{pmatrix}.\label{eq:moment_sim}
\end{equation}
The instruments are again constructed from exogenous data: $X$ for
the mean equations and $Z$ for the covariance restriction. Estimation
proceeds by finding the parameter vector $\hat{\theta}$ that minimizes
the sample analog of the moment conditions, $\bar{Q}(\theta)\T W\bar{Q}(\theta)$,
where $W$ is a weighting matrix.

\section{Set Identification Under a Relaxed Covariance Restriction}

When assumption (A2) is weakened to allow for a small correlation,
$|\corr(Z,\varepsilon_{1}\varepsilon_{2})|\le\tau|\corr(Z,\varepsilon_{2}^{2})|,\;\tau\in[0,1)$,
the parameter $\gamma_{1}$ in the triangular model is set-identified
rather than point-identified.

\begin{theorem}[Bounds for \(\gamma_1\) with \(\tau>0\)] \label{thm:bounds}
$\gamma_{1}$ is contained in the closed interval whose endpoints
are the (real) roots of the quadratic equation in $\gamma_{1}$:
\[
\frac{\cov(Z,W_{1}W_{2})^{2}}{\cov(Z,W_{2}^{2})^{2}}-\frac{\var(W_{1}W_{2})}{\var(W_{2}^{2})}\tau^{2}+2\!\left(\frac{\cov(W_{1}W_{2},W_{2}^{2})}{\var(W_{2}^{2})}\tau^{2}-\frac{\cov(Z,W_{1}W_{2})}{\cov(Z,W_{2}^{2})}\right)\!\gamma_{1}+(1-\tau^{2})\gamma_{1}^{2}=0.
\]
\end{theorem} The interval collapses to the point estimate from \eqref{eq:gamma1_id}
when $\tau=0$ and widens as $\tau\to1$.

\paragraph{Identification of other parameters.}

The remaining parameters are identified conditional on a value of
$\gamma_{1}$ from its identified set.
\begin{itemize}
\itemsep0pt
\item The parameter $\beta_{2}$ is always point-identified by OLS: $\hat{\beta}_{2} \coloneqq (\E[X\T X])^{-1}\E[X\T Y_{2}]$.
\item For each value $\gamma_{1,k}$ in the identified interval for $\gamma_{1}$,
there is a corresponding identified value for $\beta_{1}$, given
by $\beta_{1,k} \coloneqq (\E[X\T X])^{-1}\E[X\T(Y_{1}-Y_{2}\gamma_{1,k})]$.
\end{itemize}
The result is an identified set of parameter pairs $(\beta_{1},\gamma_{1})$
corresponding to the interval for $\gamma_{1}$.

\section{Two Illustrative Extensions}

The core idea can be adapted to other contexts by creatively defining
the heteroscedasticity-generating variable $Z$.

\subsection{Conditional heteroscedasticity (Prono)}

\paragraph{Context and Model.}

In a time-series setting, the structural model is a triangular system:
\begin{align*}
Y_{1t} & =X_{t}\T\beta_{1}+\gamma_{1}Y_{2t}+\varepsilon_{1t}\\
Y_{2t} & =X_{t}\T\beta_{2}+\varepsilon_{2t}
\end{align*}
The key insight is that the error variance may be time-varying and
predictable. Prono's extension assumes $\varepsilon_{2t}$ follows
a GARCH process, where its conditional variance is a function of past
errors and variances:
\[
\var(\varepsilon_{2t}\mid\mathcal{F}_{t-1}) \coloneqq \sigma_{2t}^{2} \coloneqq \omega+\alpha\varepsilon_{2,t-1}^{2}+\beta\sigma_{2,t-1}^{2}.
\]


\paragraph{Procedure.}

The fitted conditional variance from the GARCH model serves as the
heteroscedasticity driver.
\begin{enumerate}
\itemsep2pt
\item Estimate the second equation by OLS to get residuals $\hat{\varepsilon}_{2t} \coloneqq Y_{2t}-X_{t}\T\hat{\beta}_{2}$.
\item Fit a GARCH(1,1) model to the residuals $\hat{\varepsilon}_{2t}$
to obtain the series of fitted conditional variances, $\hat{\sigma}_{2t}^{2}$.
\item This fitted variance is the heteroscedasticity driver: set $Z_{t} \coloneqq \hat{\sigma}_{2t}^{2}$.
\item Construct the generated instrument: $IV_{t} \coloneqq (Z_{t}-\bar{Z})\hat{\varepsilon}_{2t}$.
\item Proceed with 2SLS as in Section 4.2, using $[X_{t},IV_{t}]$ as instruments
for $Y_{2t}$ in the first structural equation. Use HAC-robust standard
errors.
\end{enumerate}

\subsection{Regime heteroscedasticity (Rigobon)}

\paragraph{Context and Model.}

The model is a simultaneous system where the error variances differ
across observable, discrete regimes (e.g., pre- and post-policy change,
or high- vs. low-volatility periods).
\begin{align*}
Y_{1} & =X\T\beta_{1}+\gamma_{1}Y_{2}+\varepsilon_{1}\\
Y_{2} & =X\T\beta_{2}+\gamma_{2}Y_{1}+\varepsilon_{2}
\end{align*}
The key assumption is that for at least one error term $\varepsilon_{j}$,
its variance changes across regimes $s$, while the covariance between
the errors remains constant:
\begin{align*}
\var(\varepsilon_{j}\mid s) & \neq\var(\varepsilon_{j}\mid s')\quad\text{for }s\neq s'\\
\cov(\varepsilon_{1},\varepsilon_{2}\mid s) & =\text{constant for all }s.
\end{align*}


\paragraph{Procedure.}

The regime indicators are used to generate the instrument.
\begin{enumerate}
\itemsep2pt
\item Estimate the second equation by OLS to get residuals $\hat{\varepsilon}_{2}$.
\item Create a set of dummy variables $\{D_{1},\dots,D_{S}\}$ for the regimes.
\item The heteroscedasticity drivers are these dummies: set $Z$ to be the
vector of centered dummies, $Z_{s} \coloneqq D_{s}-p_{s}$, where $p_{s}$ is
the sample proportion of observations in regime $s$.
\item Construct the generated instrument(s): $IV_{s} \coloneqq Z_{s}\hat{\varepsilon}_{2}$.
\item Proceed with 2SLS, using $[X,IV_{1},\dots,IV_{S}]$ as instruments
for $Y_{2}$ in the main equation.
\end{enumerate}

\section{Time-Series Variant with Log-Linear Conditional Variances}

\label{sec:timeseries}

\paragraph{Context and Model.}

This extension formalizes identification within a GMM framework for
a stationary and mixing time series. The structural model is a simultaneous
system:
\begin{align*}
Y_{1t} & =X_{t}\T\beta_{1}+\gamma_{1}Y_{2t}+\varepsilon_{1t}\\
Y_{2t} & =X_{t}\T\beta_{2}+\gamma_{2}Y_{1t}+\varepsilon_{2t}
\end{align*}
The key assumption is that the conditional variances are an explicit
log-linear function of the exogenous variables $X_{t}$:
\[
\log\sigma_{jt}^{2} \coloneqq X_{t}\T\delta_{j},\quad\text{where}\quad\varepsilon_{jt}\mid\mathcal{F}_{t-1}\sim(0,\sigma_{jt}^{2})\quad\text{for }j=1,2.
\]
Since $(\delta_{1},\delta_{2})$ are assumed non-zero, $X_{t}$ is
correlated with $\varepsilon_{jt}^{2}$, satisfying the instrument
relevance condition (A3). The heteroscedasticity driver is defined
as the centered exogenous variables, $Z_{t} \coloneqq X_{t}-\E[X_{t}]$.

\subsection{Moment vector}

The full set of parameters is $\theta \coloneqq (\beta_{1}\T,\beta_{2}\T,\gamma_{1},\gamma_{2},\delta_{1}\T,\delta_{2}\T)\T$.
The moment conditions implied by the model are $\E[Q_{t}(\theta)]=0$,
where:
\[
Q_{t}(\theta) \coloneqq \begin{pmatrix}X_{t}\varepsilon_{1t}(\theta)\\[2pt]
X_{t}\varepsilon_{2t}(\theta)\\[2pt]
Z_{t}\varepsilon_{1t}(\theta)\varepsilon_{2t}(\theta)\\[2pt]
Z_{t}\!\left(\varepsilon_{1t}(\theta)^{2}-e^{X_{t}\T\delta_{1}}\right)\\[2pt]
Z_{t}\!\left(\varepsilon_{2t}(\theta)^{2}-e^{X_{t}\T\delta_{2}}\right)
\end{pmatrix}.
\]


\paragraph{Instruments as Functions of Observables.}

The instruments are derived from the exogenous variables $X_{t}$.
The terms inside the expectation are functions of these instruments
and the structural errors (e.g., $\varepsilon_{1t}(\theta) \coloneqq Y_{1t}-X_{t}\T\beta_{1}-Y_{2t}\gamma_{1}$),
which are themselves functions of the observable data and the parameter
vector $\theta$.
\begin{itemize}
\item For the first two mean equations, the instruments are $X_{t}$.
\item For the error product and variance specification moments, the instrument
is $Z_{t} \coloneqq X_{t}-\E[X_{t}]$, estimated in-sample as $X_{t}-\bar{X}$.
\end{itemize}
Therefore, the sample average of $Q_{t}(\theta)$ is a computable
criterion function for any candidate parameter values.

\subsection{Estimation}

Estimation proceeds via a multi-step GMM procedure:
\begin{enumerate}
\itemsep2pt
\item Obtain initial estimates of mean parameters via OLS/IV, and get residuals
$\hat{\varepsilon}_{jt}$.
\item Estimate the variance parameters $\delta_{j}$ by regressing $\log\hat{\varepsilon}_{jt}^{2}$
on $X_{t}$.
\item Use the full set of moment conditions defined in $Q_{t}(\theta)$
to form a GMM criterion function.
\item Minimize the GMM objective function using a HAC-robust weighting matrix
(e.g., Newey-West) to obtain efficient, consistent, and asymptotically
normal estimates of $\hat{\theta}$. A conventional bandwidth choice
is $\ell_{T} \coloneqq \lfloor4(T/100)^{2/9}\rfloor$.
\end{enumerate}

\section{Diagnostic Tests and Practical Checks}
\begin{itemize}
\itemsep2pt
\item \textbf{Instrument relevance.} Report the first-stage $F$-statistic
on the generated instrument(s); if $F<10$, standard inference is
unreliable, and weak-IV-robust tests should be used.
\item \textbf{Instrument validity.} If there are more heteroscedasticity
drivers $Z$ than needed for identification (i.e., the model is overidentified),
a Hansen $J$-test of overidentifying restrictions can be used to
test the validity of the moment conditions.
\item \textbf{Endogeneity of $Y_{2}$.} The endogeneity of $Y_{2}$ can
be tested using a difference-in-Hansen test (C-statistic) or a Hausman-style
test comparing the OLS and 2SLS estimates of $\gamma_{1}$.
\item \textbf{Heteroscedasticity of $\varepsilon_{2}$.} The crucial assumption
(A3) can be checked with a Breusch--Pagan or White test for heteroscedasticity,
by regressing the squared residuals $\hat{\varepsilon}_{2}^{2}$ on
the proposed driver(s)~$Z$. A significant relationship provides
evidence for instrument relevance.
\end{itemize}

\end{document}
